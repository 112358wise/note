
http框架大致由一个核心模块(ngx_http_module)、两个http模块(ngx_http_core_module、ngx_http_upstream_module)组成，它将负责调度其他http模块来一起处理用户请求。

http框架的初始化流程：
初始化所有http模块的ctx_index序号
分配解析main级别配置项时存放http模块结构体指针的3个数组
调用所有http模块的create_main_conf方法
调用所有http模块的create_srv_conf方法
调用所有http模块的create_loc_conf方法
调用所有http模块的preconfigureation方法
解析所有main级别配置项
调用所有http模块的init_main_conf方法
合并server、location相关配置项
构造location组成的静态二叉平衡查找树
初始化可添加处理方法的7个http阶段的动态数组
调用所有http模块的postconfiguration方法使之可以介入http阶段
构造phase_engine handlers数组
构造server虚拟主机构成的支持通配符的散列表
构造监听端口与server间的关联关系，设置新连接事件的回调函数












http框架设计目的：
http框架针对基于tcp的事件框架解决http的网络传输、解析、组装等问题。
http框架为http模块屏蔽事件驱动架构，使http模块不必关心网络事件的处理，同时又能灵活地介入11个阶段处理请求。

http框架的任务：
集成事件驱动机制，管理用户发起的tcp连接，处理网络读写事件，并在定时器中处理请求超时的事件。
与各个http模块共同处理请求。
设计实现subrequest功能。
提供基本的工具接口，供各http模块使用，诸如接收http包体，以及发送http响应头部、响应包体等。

